import Discussion from "phaseclient/discussion";
import User from "phaseclient/user";
import UserStatus from "phasecore/userstatus";

class PeopleEntry {
    private _user: User;
    private _isCreator: boolean;
    private _isModerator: boolean;

    constructor(user: User, discussion: Discussion | null) {
        this._user = user;

        if (discussion !== null) {
            this._isCreator = discussion.getCreator() === user.getId();
            this._isModerator = discussion.getModerators()[user.getId()];
        } else {
            this._isCreator = false;
            this._isModerator = false;
        }
    }

    public getContent(): string {
        const iconClass = this._user.getStatus() === UserStatus.Offline ? " user-status-offline" : "";
        const title = this._user.getStatus() === UserStatus.Offline ? "Offline" : "Online";
        const creatorClass = this._isCreator ? " people-username-creator" : "";
        const moderatorClass = this._isModerator ? " people-username-moderator" : "";
        const creatorOrModClass = this._isCreator ? creatorClass : moderatorClass;

        return `
        <li>
            <div class="people_user_avatar">
                <img class="avatar_${this._user.getId()}" src="${this._user.getAvatar()}"/>
            </div>
            <div class="people_user_right">
                <span class="people-username${creatorOrModClass}">${this._user.getFormatName()}</span>
            </div>
            <i class="fa fa-circle${iconClass}" data-toggle="tooltip" data-placement="left" title="${title}"></i>
        </li>`;
    }
}

export default PeopleEntry;
