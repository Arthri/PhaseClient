import * as $ from "jquery";
import Client from "phaseweb/client";
import ElementIdentifiers from "phaseweb/elementidentifiers";
import PeopleSection from "phaseweb/pagemodel/peoplesection";

class PeopleSectionEvents {
    private _peopleSection: PeopleSection;
    private _client: Client;

    constructor(peopleSection: PeopleSection, client: Client) {
        this._peopleSection = peopleSection;
        this._client = client;
        this.registerEvents();
    }

    /**
     * Registers the events for the people section
     */
    private registerEvents(): void {
        this.registerUsersBodyClick();
        this.registerUsersInDiscussionClick();
        this.registerPhaseUsersOnlineClick();
    }

    /**
     * Prevents drop down from closing when the body of it is clicked
     */
    private registerUsersBodyClick(): void {
        $(ElementIdentifiers.PeopleSection.list).on("mousedown", (e) => {
            e.stopPropagation();
        });
    }

    /**
     * Registers the click event on the discussion users drop down
     */
    private registerUsersInDiscussionClick(): void {
        $(ElementIdentifiers.PeopleSection.discussionUsers).on("mousedown", function() {
            const list = $(this).children(ElementIdentifiers.PeopleSection.list).first();
            if (list.css("display") === "none") {
                list.css("display", "block");
            } else {
                list.css("display", "none");
            }
        });
    }

    /**
     * Registers the click event on the phase users drop down
     */
    private registerPhaseUsersOnlineClick(): void {
        $(ElementIdentifiers.PeopleSection.phaseUsers).on("mousedown", function() {
            const list = $(this).children(ElementIdentifiers.PeopleSection.list).first();
            if (list.css("display") === "none") {
                list.css("display", "block");
            } else {
                list.css("display", "none");
            }
        });
    }
}

export default PeopleSectionEvents;
