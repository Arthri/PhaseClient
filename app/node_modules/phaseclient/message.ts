import CoreMessage from 'phasecore/message';
import * as Moment from 'moment';
import Utils from 'phasecore/utils';

class Message extends CoreMessage {
    constructor(userId: number, avatar: string, username: string, guestname: string, content: string, timestamp: number, systemName: string, tag: string, tagColour: string) {
        super(userId, avatar, username, guestname, content, timestamp, systemName, tag, tagColour);
    }

    /* Gets a timestamp like "Saturday at 7:16 PM" */
    public getFormattedTimestamp(): string {
        return Moment(this.getTimestamp()*1000).calendar("", {
            sameDay: "[Today at] LT",
            lastWeek: "dddd [at] LT",
            sameElse: "LT, dddd Do MMM, YYYY"
        });
    }

    /* Get BBCode formatted content */
    public getContentStyled(): string {
        return Utils.bbcode(this.getContent().getContentWithHtmlEscaped());
    }
}

export default Message;