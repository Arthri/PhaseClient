import Conversions from 'phaseclient/bbcode/conversions';

class BBCode {
    static convertText(text: string) {
        if (typeof text === 'undefined' || text === null)
            return text;

        text = text.replace(/\r?\n/g, '<br />');

        for (let i = 0; i < Conversions.length; i++) {
            text = text.replace(<RegExp>Conversions[i][0], <string>Conversions[i][1]);
        }

        // This only allows "<br />" (new lines) if the new line is not inside a <ul> and/or <li>
        text = text.replace("/(?!(\<ul\>|\<li\>|\<\/li\>).*?)\\n(?!((?!<).)*?(\<\/ul\>|\<\/li\>|\<li\>))/is", ' <br />');
        return text;
    }

    static displayYoutubeVideo(elem) {
        var videoID = elem.attr('data-id');
        var parent = elem.parent();
        elem.remove();
        parent.append('<iframe width="640" height="360" src="https://www.youtube.com/embed/' + videoID + '?modestbranding=1&rel=0&autoplay=1&wmode=transparent&theme=light&color=white" frameborder="0" allowfullscreen></iframe>');
    }
}

export default BBCode;